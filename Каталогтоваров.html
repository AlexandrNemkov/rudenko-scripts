<script>
    (function(){
        const zeroblock = document.querySelector('#rec1279145061');
        const catalog = document.querySelector('#rec1252581816');
        
        // Система кликов по цветовым фильтрам
        function initColorFilterSystem() {
            document.addEventListener('click', function(e) {
                // Проверяем клик по ссылкам с якорями colorfilter1, colorfilter2, etc.
                const colorFilterLink = e.target.closest('a[href^="#colorfilter"]');
                if (colorFilterLink) {
                    e.preventDefault();
                    
                    // Извлекаем номер из href (например, #colorfilter1 -> 1)
                    const href = colorFilterLink.getAttribute('href');
                    const match = href.match(/#colorfilter(\d+)/);
                    if (match) {
                        const filterIndex = parseInt(match[1]) - 1; // Преобразуем в 0-based индекс
                        clickColorFilter(filterIndex);
                    }
                }
            });
        }
        
        // Система кликов по размерам
        function initSizeFilterSystem() {
            document.addEventListener('click', function(e) {
                // Проверяем клик по ссылкам с якорем #filtersize
                const sizeFilterLink = e.target.closest('a[href="#filtersize"]');
                if (sizeFilterLink) {
                    e.preventDefault();
                    
                    // Получаем размер из data-size атрибута или текста ссылки
                    const sizeValue = sizeFilterLink.getAttribute('data-size') || 
                                   sizeFilterLink.textContent?.trim();
                    
                    if (sizeValue) {
                        clickSizeFilter(sizeValue);
                    }
                }
            });
        }
        
        // Функция получения всех цветов из каталога
        function getCatalogColors() {
            if (!catalog) {
                console.log('Каталог не найден');
                return [];
            }
            
            const colors = [];
            
            // Пробуем разные селекторы для поиска цветовых фильтров
            const selectors = [
                '.t-store_filter_checkbox_color',
                '.t-store_filter_checkbox',
                '.t-store_filter_item_color .t-checkbox_control',
                '.t-store_filter_item_color label',
                '.t-store_filter_item_color input[type="checkbox"]',
                '[data-filter-label="цвет"] .t-checkbox_control',
                '[data-filter-label="цвет"] label',
                '[data-filter-label="цвет"] input[type="checkbox"]',
                '.t-store_filter_item-controls-container_color .t-checkbox_control',
                '.t-store_filter_item-controls-container_color label',
                '.t-store_filter_item-controls-container_color input[type="checkbox"]'
            ];
            
            let colorFilters = [];
            let usedSelector = '';
            
            // Пробуем каждый селектор
            for (const selector of selectors) {
                colorFilters = catalog.querySelectorAll(selector);
                if (colorFilters.length > 0) {
                    usedSelector = selector;
                    console.log(`Найдены фильтры с селектором: ${selector}, количество: ${colorFilters.length}`);
                    break;
                }
            }
            
            if (colorFilters.length === 0) {
                console.log('Не найдены цветовые фильтры ни с одним селектором');
                console.log('Пробуем поиск по всему документу...');
                
                // Поиск по всему документу
                const allElements = document.querySelectorAll('*');
                const foundElements = [];
                allElements.forEach(el => {
                    const text = el.textContent?.trim();
                    if (text && /^(Графитовый|Розовый|Кирпичный|Теплый желтый|Красный|Бежевый|Черный|Серый|Синий|Белый|Желтый)$/i.test(text)) {
                        if (el.tagName === 'LABEL' || el.tagName === 'INPUT' || el.classList.contains('t-checkbox')) {
                            foundElements.push(el);
                        }
                    }
                });
                colorFilters = foundElements;
                console.log('Найдено элементов с названиями цветов:', colorFilters.length);
            }
            
            const foundColorNames = new Set(); // Для отслеживания уже найденных цветов
            
            colorFilters.forEach((filter, index) => {
                // Получаем название цвета из различных атрибутов
                const colorName = filter.getAttribute('data-tooltip') || 
                                filter.getAttribute('aria-label') || 
                                filter.getAttribute('data-filter-value') ||
                                filter.getAttribute('name') ||
                                filter.textContent?.trim();
                
                if (colorName && colorName !== '' && !foundColorNames.has(colorName)) {
                    foundColorNames.add(colorName);
                    colors.push({
                        index: colors.length, // Используем текущую длину массива colors
                        name: colorName,
                        element: filter
                    });
                }
            });
            
            console.log('Найденные цвета в каталоге (без дублей):', colors);
            console.log('Использованный селектор:', usedSelector);
            console.log('Всего найдено элементов:', colorFilters.length);
            console.log('Уникальных цветов:', colors.length);
            console.log('Отфильтровано дублей:', colorFilters.length - colors.length);
            return colors;
        }
        
        // Функция получения всех размеров из каталога
        function getCatalogSizes() {
            if (!catalog) {
                console.log('Каталог не найден');
                return [];
            }
            
            const sizes = [];
            
            // Пробуем разные селекторы для поиска размеров
            const selectors = [
                '.t-store_filter_custom-sel',
                '.js-store-filter-custom-select',
                '.t-store_filter_custom-sel_buttons',
                '.t-store_filter_custom-sel_simple',
                '[data-filter-value]',
                '[data-select-val]',
                '.t-store_filter_checkbox_size',
                '.t-store_filter_item_size .t-checkbox_control',
                '.t-store_filter_item_size label',
                '.t-store_filter_item_size input[type="checkbox"]',
                '[data-filter-label="размер"] .t-checkbox_control',
                '[data-filter-label="размер"] label',
                '[data-filter-label="размер"] input[type="checkbox"]',
                '.t-store_filter_item-controls-container_size .t-checkbox_control',
                '.t-store_filter_item-controls-container_size label',
                '.t-store_filter_item-controls-container_size input[type="checkbox"]'
            ];
            
            let sizeFilters = [];
            let usedSelector = '';
            
            // Пробуем каждый селектор
            for (const selector of selectors) {
                sizeFilters = catalog.querySelectorAll(selector);
                if (sizeFilters.length > 0) {
                    usedSelector = selector;
                    console.log(`Найдены размеры с селектором: ${selector}, количество: ${sizeFilters.length}`);
                    break;
                }
            }
            
            if (sizeFilters.length === 0) {
                console.log('Не найдены размеры ни с одним селектором');
                console.log('Пробуем поиск по всему документу...');
                
                // Поиск по всему документу
                const allElements = document.querySelectorAll('*');
                const foundElements = [];
                allElements.forEach(el => {
                    const text = el.textContent?.trim();
                    if (text && /^(40|42|44|46|48|50|52|54|56|58|60)$/i.test(text)) {
                        if (el.tagName === 'LABEL' || el.tagName === 'INPUT' || el.classList.contains('t-checkbox')) {
                            foundElements.push(el);
                        }
                    }
                });
                sizeFilters = foundElements;
                console.log('Найдено элементов с размерами:', sizeFilters.length);
            }
            
            const foundSizeNames = new Set(); // Для отслеживания уже найденных размеров
            
            sizeFilters.forEach((filter, index) => {
                // Получаем размер из различных атрибутов
                const sizeName = filter.getAttribute('data-select-val') ||
                               filter.getAttribute('data-filter-value') ||
                               filter.getAttribute('data-tooltip') || 
                               filter.getAttribute('aria-label') || 
                               filter.getAttribute('name') ||
                               filter.textContent?.trim();
                
                if (sizeName && sizeName !== '' && !foundSizeNames.has(sizeName)) {
                    foundSizeNames.add(sizeName);
                    sizes.push({
                        index: sizes.length,
                        name: sizeName,
                        element: filter
                    });
                }
            });
            
            console.log('Найденные размеры в каталоге (без дублей):', sizes);
            console.log('Использованный селектор для размеров:', usedSelector);
            console.log('Всего найдено элементов размеров:', sizeFilters.length);
            console.log('Уникальных размеров:', sizes.length);
            console.log('Отфильтровано дублей размеров:', sizeFilters.length - sizes.length);
            return sizes;
        }
        
        // Функция клика по размеру
        function clickSizeFilter(sizeValue) {
            const sizes = getCatalogSizes();
            
            const targetSize = sizes.find(size => size.name === sizeValue);
            if (targetSize) {
                console.log('Кликаем по размеру:', targetSize.name);
                targetSize.element.click();
            } else {
                console.log('Размер не найден:', sizeValue);
                console.log('Доступные размеры:', sizes.map(s => s.name));
            }
        }
        
        // Функция клика по цветовому фильтру по индексу
        function clickColorFilter(filterIndex) {
            const colors = getCatalogColors();
            
            if (filterIndex >= 0 && filterIndex < colors.length) {
                const targetColor = colors[filterIndex];
                console.log('Кликаем по фильтру:', targetColor.name, 'с индексом:', filterIndex);
                
                // Кликаем по найденному фильтру
                targetColor.element.click();
            } else {
                console.log('Индекс фильтра вне диапазона:', filterIndex, 'Доступно фильтров:', colors.length);
                console.log('Доступные цвета:', colors.map(c => c.name));
            }
        }
        
        // Инициализация систем фильтров
        initColorFilterSystem();
        initSizeFilterSystem();
        
        if (!!catalog) {
            const artboard = zeroblock?.querySelector('.t396__artboard');
            if (artboard) {
                artboard.addEventListener('artBoardRendered', (e) => {
                    const showmore = e.target.querySelector('.necodim-showmore');
                    if (showmore) {
                        showmore.addEventListener('click', (event) => {
                            event.preventDefault();
                            const showmoreAtom = zeroblock?.querySelector('.necodim-showmore .tn-atom');
                            if (showmoreAtom) {
                                showmoreAtom.classList.add('loading');
                            }
                            const loadMoreBtn = catalog.querySelector('.t-store__load-more-btn');
                            if (loadMoreBtn) {
                                loadMoreBtn.click();
                            }
                        });
                    }
                });
            }
            
            catalog.querySelector('.js-store-grid-cont').addEventListener('tStoreRendered', () => {
                if (zeroblock) {
                    zeroblock.style.display = '';
                    const showmoreAtom = zeroblock.querySelector('.necodim-showmore .tn-atom');
                    if (showmoreAtom) {
                        showmoreAtom.classList.remove('loading');
                    }
                    
                    const loadMoreBtn = catalog.querySelector('.t-store__load-more-btn');
                    if (loadMoreBtn && loadMoreBtn.style.display === 'none') {
                        zeroblock.style.display = 'none';
                    }
                    
                    if (!!catalog.querySelector('.js-store-empty-part-msg')) {
                        zeroblock.style.display = 'none';
                    }
                }
                
                // Показываем доступные цвета и размеры после загрузки каталога
                console.log('Каталог загружен, ищем цвета и размеры...');
                console.log('HTML каталога:', catalog.outerHTML.substring(0, 500) + '...');
                
                const colors = getCatalogColors();
                console.log('=== ДОСТУПНЫЕ ЦВЕТА В КАТАЛОГЕ ===');
                if (colors.length > 0) {
                    colors.forEach((color, index) => {
                        console.log(`#colorfilter${index + 1} → ${color.name}`);
                    });
                } else {
                    console.log('Цвета не найдены!');
                }
                console.log('================================');
                
                const sizes = getCatalogSizes();
                console.log('=== ДОСТУПНЫЕ РАЗМЕРЫ В КАТАЛОГЕ ===');
                if (sizes.length > 0) {
                    sizes.forEach((size, index) => {
                        console.log(`#filtersize (data-size="${size.name}") → ${size.name}`);
                    });
                } else {
                    console.log('Размеры не найдены!');
                }
                console.log('==================================');
            });
        } else {
            if (zeroblock) {
                zeroblock.style.display = 'none';
            }
        }
    }());
    </script> <style> .t-store__load-more-btn-wrap {
        display: none;
    }
    .necodim-showmore {
        cursor: pointer;
    }
    .necodim-showmore .tn-atom.loading {
        font-size: 0 !important;
    }
    .necodim-showmore .tn-atom.loading::after {
        content: '';
        width: 20px;
        aspect-ratio: 1;
        border: 2px solid #FFF;
        border-bottom-color: transparent;
        border-radius: 50%;
        display: inline-block;
        box-sizing: border-box;
        animation: rotation 1s linear infinite;
    }
    @keyframes rotation {
        0% {transform: rotate(0deg);}
        100% {transform: rotate(360deg);}
    }
    </style>